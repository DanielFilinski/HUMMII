# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API - –ë—ã—Å—Ç—Ä–∞—è –ù–∞–≤–∏–≥–∞—Ü–∏—è

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ —á–∏—Ç–∞—Ç—å |
|----------|----------|--------------|
| **[TESTING_COMPARISON.md](./TESTING_COMPARISON.md)** | üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | ‚≠ê **–ù–∞—á–Ω–∏—Ç–µ –∑–¥–µ—Å—å!** –í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥–∞ |
| **[TESTING_STRATEGY.md](./TESTING_STRATEGY.md)** | üìñ –ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω –∏ —á–µ–∫-–ª–∏—Å—Ç—ã |
| **[TEST_README.md](./TEST_README.md)** | üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≥–∞–π–¥ –ø–æ –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º | –†–∞–±–æ—Ç–∞ —Å Jest –∏ E2E —Ç–µ—Å—Ç–∞–º–∏ |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–∏–Ω –°–∫—Ä–∏–ø—Ç (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd /root/Garantiny_old/HUMMII/api
./run-all-tests.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç —Ç–µ—Å—Ç–æ–≤—É—é –ë–î
- ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç unit —Ç–µ—Å—Ç—ã (~10 —Å–µ–∫)
- ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç E2E —Ç–µ—Å—Ç—ã (~30 —Å–µ–∫)
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç –æ—Ç—á–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏—è
- ‚úÖ –ü–æ–∫–∞–∂–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Postman –∏ Swagger

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã –í—Ä—É—á–Ω—É—é
```bash
cd /root/Garantiny_old/HUMMII/api

# Unit —Ç–µ—Å—Ç—ã (–±—ã—Å—Ç—Ä—ã–µ)
npm run test:unit

# E2E —Ç–µ—Å—Ç—ã (–ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
npm run test:e2e

# –í—Å–µ —Ç–µ—Å—Ç—ã —Å—Ä–∞–∑—É
npm run test:all

# –° –æ—Ç—á–µ—Ç–æ–º –ø–æ–∫—Ä—ã—Ç–∏—è
npm run test:cov
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Postman
```bash
# 1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Postman –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏–∑:
#    docs/postman collection/Hummii-API.postman_collection.json
#    docs/postman collection/Hummii-API-Environment.postman_environment.json

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä
cd /root/Garantiny_old/HUMMII
docker compose up -d postgres redis
cd api
npm run start:dev

# 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Collection Runner –≤ Postman
```

### –í–∞—Ä–∏–∞–Ω—Ç 4: Swagger UI
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API
npm run start:dev

# 2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:3000/api/docs

# 3. –ù–∞–∂–º–∏—Ç–µ "Authorize" –∏ –≤—Å—Ç–∞–≤—å—Ç–µ JWT —Ç–æ–∫–µ–Ω
#    (–ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ POST /auth/login)

# 4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "Try it out" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
```

## üìä –ß—Ç–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ü—É—Ç–∏ (Must Have)
- ‚úÖ **Auth Flow**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –õ–æ–≥–∏–Ω ‚Üí Refresh ‚Üí Logout
- ‚úÖ **Order Lifecycle**: –°–æ–∑–¥–∞–Ω–∏–µ ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏—è ‚Üí Proposal ‚Üí –ü—Ä–∏–Ω—è—Ç–∏–µ ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- ‚úÖ **Subscription Flow**: –°–æ–∑–¥–∞–Ω–∏–µ ‚Üí Upgrade ‚Üí Downgrade ‚Üí Cancel
- ‚úÖ **Payment Flow**: Stripe integration (webhooks)
- ‚úÖ **PIPEDA Compliance**: Export data, Delete account

### –í–∞–∂–Ω—ã–µ –ú–æ–¥—É–ª–∏
- ‚úÖ Users (–ø—Ä–æ—Ñ–∏–ª–∏, —Ä–æ–ª–∏)
- ‚úÖ Contractors (–ø—Ä–æ—Ñ–∏–ª–∏, –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ)
- ‚úÖ Orders & Proposals
- ‚úÖ Chat (—Å–æ–æ–±—â–µ–Ω–∏—è, –º–æ–¥–µ—Ä–∞—Ü–∏—è)
- ‚úÖ Reviews (—Ä–µ–π—Ç–∏–Ω–≥–∏, –æ—Ç–∑—ã–≤—ã)
- ‚úÖ Notifications (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- ‚úÖ Disputes (—Å–ø–æ—Ä—ã)
- ‚úÖ Admin (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ JWT authentication
- ‚úÖ RBAC (—Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞)
- ‚úÖ Rate limiting
- ‚úÖ Input validation
- ‚úÖ File upload security

## üìà –¢–µ–∫—É—â–µ–µ –°–æ—Å—Ç–æ—è–Ω–∏–µ

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ü—Ä–æ–µ–∫—Ç–∞
```
–ú–æ–¥—É–ª–∏:      15+
–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã: 21
–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:   ~185
Unit —Ç–µ—Å—Ç—ã:  19 —Ñ–∞–π–ª–æ–≤
E2E —Ç–µ—Å—Ç—ã:   11 —Ñ–∞–π–ª–æ–≤
–ü–æ–∫—Ä—ã—Ç–∏–µ:    ~70%
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ –¢–µ—Å—Ç–∞–º–∏

**Unit Tests (—Å–µ—Ä–≤–∏—Å–Ω–∞—è –ª–æ–≥–∏–∫–∞):**
- ‚úÖ Auth Service
- ‚úÖ Users Service
- ‚úÖ Admin Service
- ‚úÖ Orders & Proposals Services
- ‚úÖ Reviews Service
- ‚úÖ Subscriptions Service
- ‚úÖ Notifications Service
- ‚úÖ Disputes Service
- ‚úÖ Contractors Service
- ‚úÖ Categories Service
- ‚úÖ Analytics Service
- ‚úÖ SEO Services
- ‚úÖ Chat Moderation
- ‚úÖ Email Service
- ‚úÖ Audit Service

**E2E Tests (–ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è):**
- ‚úÖ Auth Flow
- ‚úÖ Users CRUD
- ‚úÖ Admin Management
- ‚úÖ Orders & Proposals
- ‚úÖ Chat
- ‚úÖ Reviews
- ‚úÖ Subscriptions
- ‚úÖ Disputes
- ‚úÖ Notifications
- ‚úÖ Rate Limiting
- ‚úÖ SEO & Analytics

**Postman Collection:**
- ‚úÖ –í—Å–µ 185+ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ Environment variables
- ‚úÖ Pre-request scripts
- ‚úÖ Test assertions

**Swagger:**
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ Try-it-out —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–π –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
# –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞
npm run test:unit        # 5-10 —Å–µ–∫
```

### –ü–µ—Ä–µ–¥ –ö–æ–º–º–∏—Ç–æ–º
```bash
npm run test:all         # 30-40 —Å–µ–∫
```

### –ü–µ—Ä–µ–¥ Pull Request
```bash
npm run test:all
npm run test:cov
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ coverage >= 70%
```

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å API —Å–µ—Ä–≤–µ—Ä
2. –û—Ç–∫—Ä—ã—Ç—å Postman
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Collection Runner
4. –ü—Ä–æ–π—Ç–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
5. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞–≥–∏
```

### –ü–µ—Ä–µ–¥ –†–µ–ª–∏–∑–æ–º
```
–î–µ–Ω—å 1-2: –í—Å–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã
–î–µ–Ω—å 3-4: –ü–æ–ª–Ω—ã–π Postman —á–µ–∫-–ª–∏—Å—Ç
–î–µ–Ω—å 5:   Swagger –ø—Ä–æ–≤–µ—Ä–∫–∞ + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–î–µ–Ω—å 6:   –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
–î–µ–Ω—å 7:   Release ‚úÖ
```

## üÜò –ü—Ä–æ–±–ª–µ–º—ã –∏ –†–µ—à–µ–Ω–∏—è

### –¢–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –ë–î
docker compose -f docker-compose.test.yml up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env.test
cat .env.test
```

### Postman –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:3000/api/v1/health

# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç–µ
npm run start:dev
```

### Swagger –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
```bash
# API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω
npm run start:dev

# –û—Ç–∫—Ä–æ–π—Ç–µ
http://localhost:3000/api/docs
```

### –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?
```bash
# –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
cat TESTING_STRATEGY.md

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤
cat TESTING_COMPARISON.md

# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
cat TEST_README.md

# Postman –≥–∞–π–¥
cat ../docs/postman\ collection/README.md
```

## üìû –ë—ã—Å—Ç—Ä—ã–µ –°—Å—ã–ª–∫–∏

**–ê–≤—Ç–æ—Ç–µ—Å—Ç—ã:**
- Jest: https://jestjs.io/
- NestJS Testing: https://docs.nestjs.com/fundamentals/testing
- Supertest: https://github.com/visionmedia/supertest

**Postman:**
- Learning: https://learning.postman.com/
- Collection Runner: https://learning.postman.com/docs/collections/running-collections/intro-to-collection-runs/

**Swagger:**
- OpenAPI Spec: https://swagger.io/specification/
- NestJS Swagger: https://docs.nestjs.com/openapi/introduction

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] Node.js –∏ npm —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Docker –∏ docker-compose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`npm install`)
- [ ] `.env` —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ—Ä—Ç 5432 –¥–ª—è dev, 5433 –¥–ª—è test)
- [ ] Redis –¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ—Ä—Ç 6379)
- [ ] Postman —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- [ ] –ë—Ä–∞—É–∑–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω (–¥–ª—è Swagger UI)

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å:
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã (70% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- ‚úÖ Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è (185+ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ù–∞—á–Ω–∏—Ç–µ —Å**: `./run-all-tests.sh` ‚ö°

---

**–°–æ–∑–¥–∞–Ω–æ**: 13 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
