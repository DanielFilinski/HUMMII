# üîå WebSocket Quick Start

**–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è WebSocket –≤ Hummii API**

---

## ‚ö° 3-–º–∏–Ω—É—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç (30 —Å–µ–∫—É–Ω–¥)

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ Postman Desktop (v10.18+)
2. File ‚Üí Import
3. –í—ã–±–µ—Ä–∏—Ç–µ: Hummii-WebSocket.postman_collection.json
4. –í—ã–±–µ—Ä–∏—Ç–µ: Hummii-API-Environment.postman_environment.json
5. –í—ã–±–µ—Ä–∏—Ç–µ Environment: "Hummii API - Local"
```

### –®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω (1 –º–∏–Ω—É—Ç–∞)

```
1. –í –∫–æ–ª–ª–µ–∫—Ü–∏–∏ "Hummii API" –Ω–∞–π–¥–∏—Ç–µ "Auth ‚Üí Login"
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å —Å –≤–∞—à–∏–º–∏ credentials
3. access_token –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ {{access_token}}
```

### –®–∞–≥ 3: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Chat (30 —Å–µ–∫—É–Ω–¥)

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ "üí¨ Chat WebSocket ‚Üí Connect to Chat"
2. URL —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω: ws://{{base_url_ws}}/chat?token={{access_token}}
3. –ù–∞–∂–º–∏—Ç–µ "Connect"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–µ–ª–µ–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ "Connected"
```

### –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (1 –º–∏–Ω—É—Ç–∞)

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ "Send Message" request
2. –í Body —É–∂–µ –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä JSON
3. –ó–∞–º–µ–Ω–∏—Ç–µ {{test_order_id}} –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π order ID
4. –ù–∞–∂–º–∏—Ç–µ "Send"
5. –°–º–æ—Ç—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç –≤ –ø–∞–Ω–µ–ª–∏ "Messages"
```

**–ì–æ—Ç–æ–≤–æ!** üéâ WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## üéØ –ß—Ç–æ –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?

### Chat (üí¨ /chat)

| –§—É–Ω–∫—Ü–∏—è | Event | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|----------|
| –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è | `join_order_chat` | –í–æ–π—Ç–∏ –≤ —á–∞—Ç –∑–∞–∫–∞–∑–∞ |
| –û—Ç–ø—Ä–∞–≤–∏—Ç—å | `send_message` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ |
| –ü–µ—á–∞—Ç–∞–µ—Ç | `typing` | –ü–æ–∫–∞–∑–∞—Ç—å "–ø–µ—á–∞—Ç–∞–µ—Ç..." |
| –ü—Ä–æ—á–∏—Ç–∞–Ω–æ | `mark_as_read` | –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ |
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å | `edit_message` | –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ |

### Notifications (üîî /notifications)

| –§—É–Ω–∫—Ü–∏—è | Event | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|----------|
| –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è | auto | –ê–≤—Ç–æ-–ø–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ |
| –ü—Ä–æ—á–∏—Ç–∞—Ç—å | `notification:mark-read` | –û—Ç–º–µ—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ |
| –ü–æ–ª—É—á–∏—Ç—å | auto | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |

---

## üìù –ü—Ä–∏–º–µ—Ä: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

### –í Postman WebSocket Request

```json
{
  "event": "send_message",
  "data": {
    "orderId": "–≤–∞—à-order-uuid",
    "content": "Hello from WebSocket!",
    "type": "TEXT"
  }
}
```

### –û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

```json
{
  "event": "message_sent",
  "data": {
    "id": "msg-uuid",
    "orderId": "order-uuid",
    "content": "Hello from WebSocket!",
    "type": "TEXT",
    "createdAt": "2025-11-13T12:00:00Z"
  }
}
```

---

## üß™ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### Browser Console (F12)

```javascript
// 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å Socket.IO
const script = document.createElement('script');
script.src = 'https://cdn.socket.io/4.5.4/socket.io.min.js';
document.head.appendChild(script);

// 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è (–ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏)
const socket = io('http://localhost:3000/chat', {
  auth: { token: 'YOUR_JWT_TOKEN' }
});

// 3. –°–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏—è
socket.on('connect', () => console.log('Connected!'));
socket.on('message_sent', (data) => console.log('Sent:', data));

// 4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
socket.emit('send_message', {
  orderId: 'order-uuid',
  content: 'Hello!',
  type: 'TEXT'
});
```

### wscat CLI

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
npm install -g wscat

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
wscat -c "ws://localhost:3000/chat?token=YOUR_TOKEN"

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ JSON)
{"event":"send_message","data":{"orderId":"uuid","content":"Hi!","type":"TEXT"}}
```

---

## üêõ Troubleshooting

### ‚ùå "Connection refused"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ API –∑–∞–ø—É—â–µ–Ω
curl http://localhost:3000/api/v1/health

# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç–µ
cd api && npm run start:dev
```

### ‚ùå "Unauthorized" –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ access_token –Ω–µ expired
2. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ POST /auth/login
3. –¢–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ {{access_token}}
4. –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ WebSocket
```

### ‚ùå –°–æ–±—ã—Ç–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã (–∑–µ–ª–µ–Ω—ã–π —Å—Ç–∞—Ç—É—Å)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è event
3. –î–ª—è chat: —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ join_order_chat
4. –û—Ç–∫—Ä–æ–π—Ç–µ Postman Console –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤
```

### ‚ùå "Order not found" –∏–ª–∏ "Forbidden"

**–†–µ—à–µ–Ω–∏–µ:**
```
1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ POST /orders
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ID –∏–∑ –æ—Ç–≤–µ—Ç–∞ –≤ {{test_order_id}}
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫–∞–∑—É
```

---

## üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[WEBSOCKET_TESTING_GUIDE.md](./WEBSOCKET_TESTING_GUIDE.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (70+ —Å—Ç—Ä–∞–Ω–∏—Ü)
  - –í—Å–µ —Å–æ–±—ã—Ç–∏—è –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
  - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
  - Performance benchmarks
  - –î–µ—Ç–∞–ª—å–Ω—ã–π troubleshooting

- **[README.md](./README.md)** - –û–±–∑–æ—Ä –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

- [ ] Postman Desktop v10.18+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ WebSocket –∫–æ–ª–ª–µ–∫—Ü–∏—è
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω Environment
- [ ] API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (localhost:3000)
- [ ] –ü–æ–ª—É—á–µ–Ω JWT —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ /auth/login
- [ ] –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ ws://localhost:3000/chat
- [ ] –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ (–∏–ª–∏ –µ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
- [ ] –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —á–∞—Ç—É (join_order_chat)
- [ ] –û—Ç–ø—Ä–∞–≤–∏–ª —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] –ü–æ–ª—É—á–∏–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (message_sent)

**–í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!** üéâ

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–î–µ—Ä–∂–∏—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º** - WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∫–∞ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** - `{{test_order_id}}` —É–¥–æ–±–Ω–µ–µ —á–µ–º –∫–æ–ø–∏–ø–∞—Å—Ç–∞
3. **–°–º–æ—Ç—Ä–∏—Ç–µ Console** - View ‚Üí Show Postman Console –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–¥–≤–æ–µ–º** - –û—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–∞ –æ–∫–Ω–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ chat flow
5. **Rate limits** - –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –±–æ–ª—å—à–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É

---

**–°–æ–∑–¥–∞–Ω–æ:** 13 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** [–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ ‚Üí](./WEBSOCKET_TESTING_GUIDE.md)
